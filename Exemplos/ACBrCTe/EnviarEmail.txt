     Ok:=False;
     if Endereco<>''
      then begin
       Mensagem.Clear;
       sCC.Clear;
       Mensagem.Add('CT-e: '+Copy(CTe.Conhecimentos.Items[i].CTe.inFCTe.ID,4,44));
       sCC.Add(Trim(DM_CTA.EmpresaEmail.AsString));
       sCC.Add(CopiaPara);

       DM_CTA.TabHost.Last;
       jHost:=DM_CTA.TabHost.RecordCount;
       iHost:=1;
       DM_CTA.TabHost.First;
       Falha:=False;
       repeat
        MemoStatus.Lines.Add(' CT-e: '+Copy(CTe.Conhecimentos.Items[i].CTe.inFCTe.ID,4,44));
        MemoStatus.Lines.Add(' Destinatário: ' + Endereco);
        MemoStatus.Lines.Add('  Aguarde... Enviando CT-e por e-mail. Host ['+
           IntToStr(iHost)+']  ');
        ConexaoSSL := (DM_CTA.TabHostPortaSMTP.AsInteger<>25);

        try

         CTe.Conhecimentos.Items[i].EnviarEmail(DM_CTA.TabHostServidorSMTP.AsString,
                                      DM_CTA.TabHostPortaSMTP.AsString,
                                      DM_CTA.TabHostUsuario.AsString,
                                      DM_CTA.TabHostSenha.AsString,
                                      DM_CTA.EmpresaEmail.AsString,
                                      Endereco,
                                      'CT-e',
                                      Mensagem,
                                      ConexaoSSL,                  // SSL
                                      EnviaPDF,                    // Enviar em PDF
                                      sCC,                         // sCC
                                      nil,                         // Anexos
                                      PedeConfirmacao,             // Pede Confirmação de Recebimento
                                      AguardarEnvio,               // Aguarda o Envio
                                      DM_CTA.EmpresaNome.AsString, // Nome do remetente
                                      UsaIndy);
         Ok:=True;
        except
         DM_CTA.TabHost.Next;
         Inc(iHost);
         if iHost>jHost then Falha:=True;
        end;
       until Ok or Falha;
       if Falha
        then MessageDlg('e-mail não enviado por motivo de Falha.', mtError, [mbOk], 0);
      end
      else MessageDlg('Tomador do Serviço não possui, e-mail Cadastrado.', mtInformation, [mbOk], 0);

     DM_CNT.Conhec2.Next;
    end;
   Mensagem.Free;
   sCC.Free;
   if Ok
    then MessageDlg('e-mail enviado com Sucesso.', mtInformation, [mbOk], 0);
